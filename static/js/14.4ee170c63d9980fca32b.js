webpackJsonp([14],{"+4wr":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),n=a("Hdn/"),o={props:["title"],data:function(){return{img_src:a("eXu4"),close_icon:a("kuG5")}},methods:{closeModal:function(){this.$emit("closeMarketModal",0)}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"loading-wrapper-phone"},[a("div",{staticClass:"toast toast-loading"},[a("img",{staticClass:"closeModal",attrs:{src:t.close_icon,alt:"关闭按钮"},on:{click:t.closeModal}}),t._v(" "),a("img",{staticClass:"market",attrs:{src:t.img_src,alt:"商城暂未开通"}}),t._v(" "),a("div",{staticClass:"modalText"},[a("span",[t._v(t._s(t.title))])])])])},staticRenderFns:[]};var c=a("VU/8")(o,r,!1,function(t){a("SlVm")},"data-v-6469b600",null).exports,l={components:{headerNavBack:n.a,getIntertal:c},data:function(){return{params:{content:"",filename:null},base64:[],base:new Array,imgList:[],content:"",jobInfo:{imgList:[]},base64_container:[],title:"",taskInfo:{course:{categoryId:""}},img_arr:[],imgInfo:[],fixFile:["png","gif","jpeg","jpg"],totelCore:0,fileTotalSize:9437184,showGetIntertal:0}},methods:{closeMarketModal:function(t){this.showGetIntertal=t,this.$store.state.getMyWorkDataListPage=1,this.$store.state.getMyWorkDataList=[],this.$router.push("/workArea/all/myWorkInRange"),this.$store.commit("cleanWorkRange",this.$route.fullPath)},publishWork:function(){var t=this;this.$store.commit("clearList"),0!=this.content.length&&" "!=this.content.charAt(0)?(this.$Indicator.open({text:"保存作业中...",spinnerType:"fading-circle"}),this.imgInfo.length>0?(this.imgInfo.forEach(function(e){t.totelCore+=e.size}),this.fileTotalSize<this.totelCore?this.$Toast({message:"单张图片上传限制2M, 9张上传限制9M, 手机拍摄单张照片上传限制5M",position:"middle",duration:1e3}):this.axios.post("/api/user/saveJob",{taskId:this.$route.params.taskId,content:this.content,imgInfo:s()(this.imgInfo)}).then(function(e){if("failure"===e.data.status)return t.$Indicator.close(),void t.$Toast({message:e.data.result,position:"middle",duration:1e3});t.$Indicator.close(),t.$Toast({message:"提交作业成功",position:"middle",duration:1e3}),e.data.result.integal?t.showGetIntertal=1:setTimeout(function(){t.$router.push("/workArea/all/myWorkInRange"),t.$store.commit("cleanWorkRange",t.$route.fullPath)},1e3)}).catch(function(t){})):this.$Toast({message:"请上传作业",position:"middle",duration:1e3})):this.$Toast({message:"请阐述一下你的想法",position:"middle",duration:1e3})},changeImg:function(t){var e=this;if(-1!==this.fixFile.join("").indexOf(t.target.files[0].type.substring(t.target.files[0].type.indexOf("/")+1,t.target.files[0].type.length))){if(t.target.files[0].size>2097152)this.$Toast({message:"上传图片超过2M限制, 请重新选择上传",position:"middle",duration:1e3});else if(this.$Indicator.open({text:"上传中...",spinnerType:"fading-circle"}),t.target.files.length>0){this.base64.push(t.target.files);var a=(window.URL,window.URL.createObjectURL(t.target.files[0]));this.jobInfo.imgList.unshift(a);var i=new FileReader;i.readAsDataURL(t.target.files[0]),i.onload=function(a){e.axios.post("/api/upload_file",{content:a.target.result}).then(function(a){e.img_arr.unshift(a.data.data[0]);var i=t.target.files[0].type.replace(/image\//,"");e.imgInfo.unshift({filename:t.target.files[0].name+"."+i,url:""+a.data.data[0],size:t.target.files[0].size}),e.$Indicator.close()})}}}else this.$Toast({message:"请上传JPG, PNG, GIF格式的作业",position:"middle",duration:1e3})},deleteicon:function(t){var e=this;this.img_arr.forEach(function(a,i){i==t&&e.img_arr.splice(t,1)}),this.imgInfo.forEach(function(a,i){i==t&&e.imgInfo.splice(t,1)})}},mounted:function(){var t=this;window.onscroll=function(){},this.$Indicator.open({text:"加载中...",spinnerType:"fading-circle"}),this.axios.post("/api/taskDetail",{taskId:this.$route.params.taskId}).then(function(e){t.taskInfo=e.data,t.axios.post("/api/user/taskJobList",{taskId:e.data.taskId}).then(function(e){e.data.list[0]?(t.jobInfo=e.data.list[0],t.content=t.jobInfo.jobcompletionE.content,t.jobInfo.imgList=t.jobInfo.jobcompletionE.contentImg.split(","),t.jobInfo.imgList.forEach(function(e){t.img_arr.push(e)}),t.imgInfo=JSON.parse(t.jobInfo.jobcompletionE.imgInfo),t.$Indicator.close()):t.$Indicator.close()}).catch(function(t){})}).catch(function(t){})}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"min-height":"100vh","background-color":"#fff"}},[i("headerNavBack",{attrs:{centerTitle:"提交作业"}}),t._v(" "),i("section",[i("div",{staticClass:"task_title",domProps:{innerHTML:t._s(t.taskInfo.content)}}),t._v(" "),i("div",{staticClass:"textarea_content"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{name:"work_content",maxlength:"150",id:"work_content",placeholder:"简单阐述一下你的想法"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})]),t._v(" "),"j5m484vz"===t.taskInfo.course.categoryId?i("div",{staticClass:"font_num"},[t._m(0),i("span",[0===t.content.length?i("i",{staticClass:"default"},[t._v("0")]):t._e(),t.content.length>0?i("i",{staticClass:"default"},[t._v(t._s(150-t.content.length>0?t.content.length:150))]):t._e(),t._v("/150")])]):t._e(),t._v(" "),"j5m48deg"===t.taskInfo.course.categoryId?i("div",{staticClass:"font_num"},[t._m(1),i("span",[i("i",{staticClass:"default"}),t.content.length>0?i("i",{staticClass:"blackColor"},[t._v(t._s(150-t.content.length>0?t.content.length:150))]):t._e(),t._v("/150")])]):t._e(),t._v(" "),i("div",{staticClass:"infomation"},[t._v("注: 单张图片上传限制2M, 9张上传限制9M, 手机拍摄单张照片上传限制5M")]),t._v(" "),i("div",{staticClass:"upload_file"},[i("div",{staticClass:"imgs_uploaded"},[t._l(t.imgList,function(t,e){return i("span",{key:e},[i("img",{attrs:{src:t,alt:"上传图片"}})])}),t._v(" "),t.img_arr&&t.img_arr.length<9?i("div",{staticClass:"file_container"},[i("input",{ref:"file",staticClass:"file",attrs:{type:"file",accept:"image/*",id:"file",name:"file"},on:{change:function(e){t.changeImg(e)}}}),t._v(" "),i("img",{attrs:{src:a("YEen"),alt:"自定义上传组件"}})]):t._e(),t._v(" "),t._l(t.img_arr,function(e,a){return i("div",{key:a,staticClass:"file_container"},[i("span",{staticClass:"file_deleteicon",on:{click:function(e){t.deleteicon(a)}}},[t._v("×")]),t._v(" "),i("img",{attrs:{src:e,alt:"作业图片"}})])})],2)])]),t._v(" "),i("button",{staticClass:"submitWorkBtn",on:{click:t.publishWork}},[t._v("提交作业")]),t._v(" "),i("transition",{attrs:{"enter-active-class":"zoomIn","leave-active-class":"zoomOut"}},[t.showGetIntertal?i("get-intertal",{staticClass:"animated",attrs:{title:"恭喜获得1个积分"},on:{closeMarketModal:t.closeMarketModal}}):t._e()],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"designSchool"},[e("b",[this._v("#设计学院")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"artSchool"},[e("b",[this._v("#美术学院")])])}]};var f=a("VU/8")(l,d,!1,function(t){a("im6q")},"data-v-8c42c78c",null);e.default=f.exports},SlVm:function(t,e){},YEen:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAABkCAIAAAAKfomzAAADEUlEQVR4Ae3bvYpiQRAF4FVXRERQEQZFDczMRXNDX9BH8QEMDMTYzMRIRRDBv0S3FuEyNTNNU+e2S7Mcg8G2q3r6fvdo0prZ7XaPx+MXHxaBWq2Wz+ezlhbWKgHaKQ7TgHYmLlVMO8VhGtDOxKWKaac4TAPambhUMe0Uh2lAOxOXKqad4jANaGfiUsW0UxymAe1MXKqYdorDNKCdiUsV005xmAa0M3GpYtopDtOAdiYuVUw7xWEa0M7EpYp/q1E0g+fz+dpLJpOJZlNfNxJ17kQwQfy68QjGkebueDwuFovT6TQYDDqdTgRQP2whxtxJ1s7n83K5nM1m2+022ujFaCe3+O979fmULyzI3x/ueBwvRWr3wokZTnYYtV0c8XLugnZOGu8E7bxEzgLaOWm8E7TzEjkLaOek8U7QzkvkLKCdk8Y7QTsvkbOAdk4a7wTtvETOAto5abwTtPMSOQto56TxTtDOS+QsoJ2TxjtBOy+Rs4B2ThrvBO28RM4C2jlpvBOZsL+f3e/3k8kk5RmNtN9ut81mc71e2+12tVpN+e2Abrc7Go2azWbKdRLN1+9nA59tXy6X+Xye/sfMif5qtUp/wXIP+v1+o9GQi0+/WiIYOHf3+329XidXnvwb0xNpl3fDdDo9HA7j8bjX65navxeXSqV6vV4sFrPZMJ9Rb8ldoVBIf6liVy6XK5WKpLjVasmCocIiK4daSu5QmPvw/VanfCW5wuRJygVf7WFXi9QuiNS7F6EdLkw72uECeCdzRztcAO9k7miHC+CdzB3tcAG8k7mjHS6AdzJ3tMMF8E7mjna4AN7J3NEOF8A7mbv/zk4OZeSBX9Y/6Yw0d3IoE/Zc5h2Ygc+2Q21RzhiHw6H8bvvj4yPUmsHXCXy2HWp/8oaVLxfIQ06jc7lcqGVDrfOWs+1Qm5M3rJBFqPb5AiP9vPu8xWif0w6/NbSjHS6AdzJ3tMMF8E7mjna4AN7J3NEOF8A7mTva4QJ4J3NHO1wA72TuaIcL4J3MHe1wAbyTuaMdLoB3Mne0wwXwTuYOt/sD4+WjFgSWhv4AAAAASUVORK5CYII="},eXu4:function(t,e,a){t.exports=a.p+"static/img/tj_bg.png"},im6q:function(t,e){}});
//# sourceMappingURL=14.4ee170c63d9980fca32b.js.map