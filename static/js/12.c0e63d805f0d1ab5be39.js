webpackJsonp([12],{"5tAT":function(t,e){},"9J0G":function(t,e){},"OD/0":function(t,e,a){"use strict";var o={props:["workDetail"],components:{emojiCom:a("GGky").default},data:function(){return{textareaData:"",showEmojiStatus:!1,commentReg:/^[\s]*$/}},computed:{fontNum:function(){return 150-this.textareaData.length>0?this.textareaData.length:(this.textareaData=this.textareaData.substr(0,150),150)},LOGIN_USER_OBJECT_JOIN:function(){return this.$store.state.userModule.LOGIN_USER_OBJECT.roleList}},mounted:function(){this.$refs.textAreaRef.focus()},methods:{changeOptionStatus:function(){this.$emit("changeOptionStatus",!1),this.showEmojiStatus=!1},showEmojiModal:function(){this.showEmojiStatus=!this.showEmojiStatus},getEmoji:function(t){this.textareaData+=t},publishCommentContent:function(){var t=this;if(this.commentReg.test(this.textareaData))this.$Toast({message:"请输入内容",position:"middle",duration:1e3});else if(this.workDetail.doCommentStatus){this.workDetail.doCommentStatus=!1,this.$Indicator.open({text:"评论中...",spinnerType:"fading-circle"});var e={jobcompletionId:this.workDetail.jobcompletionId,content:this.textareaData};this.workDetail&&this.workDetail.commentId&&(e.commentId=this.workDetail.commentId),this.axios.post("/api/saveJobsComment",e).then(function(e){if(t.workDetail.doCommentStatus=!0,t.$Indicator.close(),"success"===e.data.status){var a={userId:e.data.result.userId,avatar:e.data.result.user.avatar.startsWith("http")?e.data.result.user.avatar:t.productURL+"/"+e.data.result.user.avatar,commentTime:e.data.result.commentTime,content:e.data.result.commentContent,jobcompletionId:e.data.result.jobcompletionId,nickName:e.data.result.user.nickname,commentType:"TEXT",commentId:e.data.result.jobcommentId,userRoleList:t.LOGIN_USER_OBJECT_JOIN};t.$emit("changeOptionStatus",a),t.$Toast({message:"评论成功",position:"middle",duration:1e3});var o=t.$route.fullPath;t.$store.commit("cleanAboutAndMine",o)}else t.$Toast({message:e.data.result,position:"middle",duration:1e3})}).catch(function(t){})}}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-container",on:{touchmove:function(t){t.preventDefault()}}},[a("div",{staticClass:"comment-bg",on:{click:t.changeOptionStatus}}),t._v(" "),a("div",{staticClass:"comment-wrapper"},[a("div",[a("span",{staticClass:"comment-close-modal",on:{click:t.changeOptionStatus}},[t._v("×")])]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textareaData,expression:"textareaData"}],ref:"textAreaRef",attrs:{name:"commentModal",autofocus:"",rows:"7",cols:"35",id:"commentModal",autofocus:"",maxlength:"150"},domProps:{value:t.textareaData},on:{input:function(e){e.target.composing||(t.textareaData=e.target.value)}}}),t._v(" "),a("div",{staticClass:"comment-footer"},[a("div",[a("span",[t._v(t._s(t.fontNum))]),t._v("/150")]),t._v(" "),a("div",[a("span",{staticClass:"emoji-bg",on:{click:t.showEmojiModal}}),a("span",{on:{click:t.publishCommentContent}},[t._v("发布")])])])]),t._v(" "),t.showEmojiStatus?a("emoji-com",{on:{getEmoji:t.getEmoji}}):t._e()],1)},staticRenderFns:[]};var s=a("VU/8")(o,n,!1,function(t){a("Rp/G"),a("9J0G")},"data-v-3cf5a08a",null);e.a=s.exports},"Rp/G":function(t,e){},h0C8:function(t,e){},zEvs:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("woOf"),n=a.n(o),s=a("Hdn/"),i=a("GGky"),m=a("NYxO"),c=a("K31e"),r=a("OD/0"),u=Object(m.a)("userModule"),l=(u.mapMutations,u.mapActions,u.mapState),d={components:{headerNavBack:s.a,emoji:i.default,login:c.a,commentModal:r.a},data:function(){return{centerTitle:"回复",replayObj:{page:1,pageSize:5},commentObj:null,replayCommentList:[],commentInputValue:"",placeholder:"",audioImg:a("ZVf4"),showLoginModal:0,audioPlayStatus:0,audioPlayingImg:a("Lilc"),audioLoop:null,showRangComment:!1,replayPer:"",pageStatus:!0}},computed:l(["LOGIN_USER_OBJECT"]),destroyed:function(){clearInterval(this.audioLoop)},methods:{changeFooterStatus:function(){this.LOGIN_USER_OBJECT?(this.showRangComment=!0,this.commentObj=n()(this.commentObj,{doCommentStatus:!0})):this.showLoginModal=1},changeOptionStatus:function(t){if("boolean"!=typeof t){this.replayCommentList.unshift(t),this.showRangComment=!1;var e=this.$route.query.type,a=this.$route.query.index,o=this.$store.state.workRangeModule,n={comment:t,parentComment:this.commentObj};switch(e){case"hot":o.WORK_RANGE_HEAT_OBJECT.WORK_HEAT_LIST.length>0&&(o.WORK_RANGE_HEAT_OBJECT.WORK_HEAT_LIST[a].commentList.unshift(n),++o.WORK_RANGE_HEAT_OBJECT.WORK_HEAT_LIST[a].commentNum);break;case"new":o.WORK_RANGE_COMM_OBJECT.WORK_COMM_LIST.length>0&&(o.WORK_RANGE_COMM_OBJECT.WORK_COMM_LIST[a].commentList.unshift(n),++o.WORK_RANGE_HEAT_OBJECT.WORK_COMM_LIST[a].commentNum);break;case"mine":o.WORK_RANGE_MINE_OBJECT.WORK_MINE_LIST.length>0&&(o.WORK_RANGE_MINE_OBJECT.WORK_MINE_LIST[a].commentList.unshift(n),++o.WORK_RANGE_HEAT_OBJECT.WORK_MINE_LIST[a].commentNum)}}else this.showRangComment=!1},showDialogEvent:function(t){this.showLoginModal=t},playAudio:function(t){var e=this;this.$refs.audioOption.paused?(this.audioPlayStatus=1,this.$refs.audioOption.play(),this.audioLoop=setInterval(function(){e.$refs.audioOption.paused&&(e.audioPlayStatus=0,clearInterval(e.audioLoop))},1e3)):(this.audioPlayStatus=0,this.$refs.audioOption.pause())},delJobCommentById:function(t,e){var a=this;this.$Toast({message:"删除成功",position:"middle",duration:1e3}),this.replayCommentList.splice(e,1),this.axios.post("/api/delJobCommentById",{commentId:t.commentId}).then(function(e){if("success"===e.data.status){var o=a.$route.query.type,n=a.$route.query.index,s=a.$store.state.workRangeModule;switch(o){case"hot":var i=s.WORK_RANGE_HEAT_OBJECT.WORK_HEAT_LIST;i.length>0&&(i[n].commentList.forEach(function(e,a){e.comment.commentId===t.commentId&&i[n].commentList.splice(a,1)}),--i[n].commentNum);break;case"new":var m=s.WORK_RANGE_COMM_OBJECT.WORK_COMM_LIST;m.length>0&&(m[n].commentList.forEach(function(e,a){e.comment.commentId===t.commentId&&m[n].commentList.splice(a,1)}),--m[n].commentNum);break;case"mine":var c=s.WORK_RANGE_MINE_OBJECT.WORK_MINE_LIST;c.length>0&&(c[n].commentList.forEach(function(e,a){e.comment.commentId===t.commentId&&c[n].commentList.splice(a,1)}),--c[n].commentNum)}}else a.$Toast({message:"操作异常, 请稍后重试",position:"middle",duration:1e3})}).catch(function(t){})},dropDown:function(){var t=this;this.pageStatus&&(this.loading(),this.pageStatus=!this.pageStatus,this.axios.get("/api/getCommentList",{params:{jobcompletionId:this.$route.params.jobcompletionId,commentId:this.$route.params.commentId,page:++this.replayObj.page,pageSize:this.replayObj.pageSize}}).then(function(e){t.pageStatus=!t.pageStatus,"success"===e.data.status&&(t.hideLoading(),e.data.result.list.length>0?(t.replayCommentList=t.replayCommentList.concat(e.data.result.list),t.replayCommentList.forEach(function(e){e.avatar.startsWith("http")||(e.avatar=t.productURL+e.avatar)})):(t.hideLoading(),t.pageStatus=!1,t.$Toast({message:"没有更多了",position:"middle",duration:1e3})))}).catch(function(t){}))}},mounted:function(){var t=this;window.onscroll=function(){t.scrollEvent()&&t.dropDown()},this.$route.query["@"]&&(this.replayPer=this.$route.query["@"]),this.axios.get("/api/getCommentList",{params:{jobcompletionId:this.$route.params.jobcompletionId,commentId:this.$route.params.commentId,page:this.replayObj.page,pageSize:this.replayObj.pageSize}}).then(function(e){"success"===e.data.status&&(t.replayCommentList=e.data.result.list,t.commentObj=e.data.result.replyParentComment,t.replayCommentList.forEach(function(e){e.avatar.startsWith("http")||(e.avatar=t.productURL+e.avatar)}),t.commentObj.avatar.startsWith("http")||(t.commentObj.avatar=t.productURL+t.commentObj.avatar))}).catch(function(t){})}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("header-nav-back",{attrs:{centerTitle:t.centerTitle}}),t._v(" "),a("div",{staticClass:"comment-container"},[a("div",[a("div",[a("img",{attrs:{src:t.commentObj&&t.commentObj.avatar,alt:"头像"}})]),t._v(" "),a("div",[a("span",[t._v(t._s(t.commentObj&&t.commentObj.nickName))]),t._v(" "),t.commentObj&&"AUDIO"===t.commentObj.commentType?a("span",{staticClass:"audioClass",on:{click:t.playAudio}},[a("img",{attrs:{src:t.audioPlayStatus?t.audioPlayingImg:t.audioImg,alt:"音频播放"}}),t._v(t._s(t.commentObj&&t.commentObj.audioLength)+'"\n          '),a("audio",{ref:"audioOption",attrs:{src:t.commentObj&&t.commentObj.content}})]):t._e(),t._v(" "),t.commentObj&&"TEXT"===t.commentObj.commentType?a("span",{staticClass:"emoji-convert",domProps:{innerHTML:t._s(t.convertEmotions(t.commentObj&&t.commentObj.content))}}):t._e(),t._v(" "),a("p",[a("span",[t._v(t._s(t._f("datePoint")(t.commentObj&&t.commentObj.commentTime)))])])])]),t._v(" "),t._l(t.replayCommentList,function(e,o){return t.replayCommentList&&t.replayCommentList.length>0?a("div",{key:o},[a("div",[a("img",{attrs:{src:e.avatar,alt:"头像"}})]),t._v(" "),a("div",[a("span",[t._v(t._s(e.nickName))]),t._v(" "),"TEXT"===e.commentType?a("span",{staticClass:"emoji-convert",domProps:{innerHTML:t._s(t.convertEmotions(e.content))}}):t._e(),t._v(" "),a("p",[a("span",[t._v(t._s(t._f("datePoint")(e.commentTime)))]),t._v(" "),0===e.replyCount&&t.LOGIN_USER_OBJECT&&t.LOGIN_USER_OBJECT.user.userId!==e.userId||!t.LOGIN_USER_OBJECT?a("span",[t._v("回复")]):t._e(),t._v(" "),e.replyCount>=1?a("span",[t.LOGIN_USER_OBJECT&&t.LOGIN_USER_OBJECT.user.userId!==e.userId||!t.LOGIN_USER_OBJECT?a("b",[t._v("回复")]):t._e(),a("b",[t._v(t._s(e.replyCount))])]):t._e()])]),t._v(" "),t.LOGIN_USER_OBJECT&&t.LOGIN_USER_OBJECT.user.userId===e.userId?a("div",{on:{click:function(a){t.delJobCommentById(e,o)}}},[t._v("删除")]):t._e()]):t._e()})],2),t._v(" "),t.showRangComment?a("comment-modal",{attrs:{workDetail:t.commentObj},on:{changeOptionStatus:t.changeOptionStatus}}):t._e(),t._v(" "),t.showLoginModal&&!t.LOGIN_USER_OBJECT?a("login",{on:{showDialogEvent:t.showDialogEvent}}):t._e(),t._v(" "),a("section",{staticClass:"replay-comment-footer",on:{click:t.changeFooterStatus}},[t._v("\n    回复@"+t._s(t.replayPer)+"\n  ")])],1)},staticRenderFns:[]};var _=a("VU/8")(d,p,!1,function(t){a("h0C8"),a("5tAT")},"data-v-0d07caee",null);e.default=_.exports}});
//# sourceMappingURL=12.c0e63d805f0d1ab5be39.js.map